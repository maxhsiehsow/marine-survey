<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æµ·å»¢ V16 æª¢æ¸¬</title>
    <style>
        body { font-family: sans-serif; padding: 10px; background: #fff; }
        
        /* è¶…ç´šé¡¯çœ¼çš„è¨ºæ–·æ¡† */
        #debug-box {
            position: fixed; top: 0; left: 0; width: 100%; height: 120px;
            background: #000; color: #0f0; font-family: monospace; font-size: 14px;
            padding: 5px; overflow-y: scroll; z-index: 9999; border-bottom: 2px solid red;
        }

        /* å…§å®¹å¾€ä¸‹æ¨ï¼Œé¿å…è¢«è¨ºæ–·æ¡†æ“‹ä½ */
        #content { margin-top: 130px; }

        button {
            width: 100%; padding: 15px; font-size: 18px; margin-top: 10px;
            background: #007bff; color: white; border: none; border-radius: 5px;
        }
        input, select { width: 100%; padding: 10px; font-size: 16px; margin: 5px 0; box-sizing: border-box; }
        .row { margin-bottom: 15px; border: 1px solid #ccc; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>

    <div id="debug-box">ç­‰å¾…ç¨‹å¼å•Ÿå‹•...</div>

    <div id="content">
        <h1>ğŸ› ï¸ V16 ç›¸å®¹æ€§æª¢æ¸¬</h1>
        
        <div class="row">
            <h3>1. JS æ¸¬è©¦</h3>
            <button onclick="testHello()">ğŸ‘† é»æˆ‘æ¸¬è©¦æŒ‰éˆ•</button>
            <p>å¦‚æœé»äº†æ²’åæ‡‰ï¼Œä»£è¡¨ JS è¢«é–æ­»ã€‚</p>
        </div>

        <div class="row">
            <h3>2. GPS æ¸¬è©¦</h3>
            <button onclick="runGPS()">ğŸ“ æŠ“å– GPS</button>
            <input type="text" id="gps-val" placeholder="åº§æ¨™æœƒé¡¯ç¤ºåœ¨é€™">
        </div>

        <div class="row">
            <h3>3. è¨˜éŒ„æ¸¬è©¦</h3>
            <select id="sel-country">
                <option value="å°ç£">å°ç£</option>
                <option value="ä¸­åœ‹">ä¸­åœ‹</option>
                <option value="æ—¥æœ¬">æ—¥æœ¬</option>
            </select>
            <button onclick="addItem()">â• å¢åŠ ä¸€ç­†</button>
            <div id="list" style="margin-top:10px; font-weight:bold;">ç›®å‰æ•¸é‡ï¼š0</div>
        </div>
    </div>

    <script>
        // === 1. å…¨åŸŸéŒ¯èª¤æ•æ‰ (æ”¾åœ¨æœ€å‰é¢) ===
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            var box = document.getElementById('debug-box');
            var txt = "âŒ éŒ¯èª¤: " + msg + " (è¡Œ:" + lineNo + ")";
            box.innerHTML = "<div>" + txt + "</div>" + box.innerHTML;
            return false;
        };

        // === 2. ç«‹å³åŸ·è¡Œçš„æ—¥èªŒå·¥å…· ===
        function log(msg) {
            var box = document.getElementById('debug-box');
            // åŠ ä¸Šæ™‚é–“æˆ³è¨˜
            var now = new Date();
            var time = now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds();
            box.innerHTML = "<div>[" + time + "] " + msg + "</div>" + box.innerHTML;
        }

        // === 3. ç¨‹å¼å•Ÿå‹•æª¢æ¸¬ ===
        try {
            log("æ­¥é©Ÿ1: è…³æœ¬å·²è¼‰å…¥");
            
            // ç›´æ¥ä¿®æ”¹ DOMï¼Œä¸ç­‰å¾… window.onload
            var testDiv = document.getElementById('debug-box');
            if(testDiv) {
                log("æ­¥é©Ÿ2: æŠ“åˆ°è¨ºæ–·æ¡†ï¼Œç³»çµ±æ­£å¸¸");
                testDiv.style.borderColor = "green"; // è®Šç¶ è‰²ä»£è¡¨æˆåŠŸ
            } else {
                alert("åš´é‡éŒ¯èª¤: æ‰¾ä¸åˆ°è¨ºæ–·æ¡†");
            }

        } catch(e) {
            alert("å•Ÿå‹•å¤±æ•—: " + e.message);
        }

        // === 4. åŠŸèƒ½å‡½æ•¸ (ä½¿ç”¨æœ€ç°¡å–®å¯«æ³•) ===
        
        // æ¸¬è©¦æŒ‰éˆ•
        function testHello() {
            log("æŒ‰éˆ•åæ‡‰æ­£å¸¸ï¼");
            alert("æŒ‰éˆ•æœ‰æ•ˆï¼");
        }

        // GPS
        function runGPS() {
            log("æ­£åœ¨è«‹æ±‚ GPS...");
            var inp = document.getElementById('gps-val');
            inp.value = "å®šä½ä¸­...";

            if(!navigator.geolocation) {
                log("å¤±æ•—: ç€è¦½å™¨ä¸æ”¯æ´ API");
                inp.value = "ä¸æ”¯æ´";
                return;
            }

            navigator.geolocation.getCurrentPosition(
                function(pos) {
                    var txt = pos.coords.latitude + "," + pos.coords.longitude;
                    log("GPS æˆåŠŸ: " + txt);
                    inp.value = txt;
                },
                function(err) {
                    log("GPS éŒ¯èª¤ä»£ç¢¼: " + err.code + " (" + err.message + ")");
                    inp.value = "å¤±æ•—";
                    alert("å®šä½å¤±æ•—ï¼Œè«‹ç¢ºèªæ¬Šé™ã€‚");
                },
                { timeout: 10000 }
            );
        }

        // å¢åŠ è¨˜éŒ„
        var count = 0;
        function addItem() {
            try {
                var val = document.getElementById('sel-country').value;
                count = count + 1;
                document.getElementById('list').innerText = "ç›®å‰æ•¸é‡ï¼š" + count + " (å‰›åŠ å…¥: " + val + ")";
                log("å·²è¨˜éŒ„: " + val);
            } catch(e) {
                log("è¨˜éŒ„éŒ¯èª¤: " + e.message);
            }
        }
    </script>
</body>
</html>
